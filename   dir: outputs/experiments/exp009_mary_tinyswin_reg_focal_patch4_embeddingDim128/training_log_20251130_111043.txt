/Users/maria/Desktop/AU/FALL_2025_2026/DLVR/projects/FIVES_project/DPVS_ppln/src/models/architectures/tiny_swin.py:590: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!
  assert height == self.image_size and width == self.image_size, \
/Users/maria/Desktop/AU/FALL_2025_2026/DLVR/projects/FIVES_project/DPVS_ppln/src/models/architectures/tiny_swin.py:289: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!
  assert num_tokens == height * width, \
/Users/maria/Desktop/AU/FALL_2025_2026/DLVR/projects/FIVES_project/DPVS_ppln/src/models/architectures/tiny_swin.py:361: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!
  assert patch_resolution == height * width, \
/Users/maria/Desktop/AU/FALL_2025_2026/DLVR/projects/FIVES_project/DPVS_ppln/src/models/architectures/tiny_swin.py:404: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!
  assert num_tokens == height * width, \
/Users/maria/Desktop/AU/FALL_2025_2026/DLVR/projects/FIVES_project/DPVS_ppln/src/models/architectures/tiny_swin.py:638: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!
  assert patch_resolution == final_height * final_width, \
======================================================================
Experiment: exp009_mary_tinyswin_reg_focal_patch4_embeddingDim128
Description: TinySwinUNet with regularization (aug + dropout) trained using Focal Tversky loss
======================================================================

Output directory: outputs/experiments/exp009_mary_tinyswin_reg_focal_patch4_embeddingDim128

Creating dataloaders...
  Train samples: 480
  Val samples: 120
  Test samples: 200

Creating model...
  Model: TinySwinUNet
  Parameters: 14,335,875
  Device: mps
TensorBoard logging enabled: outputs/experiments/exp009_mary_tinyswin_reg_focal_patch4_embeddingDim128/tensorboard
  View logs with: tensorboard --logdir outputs/experiments/exp009_mary_tinyswin_reg_focal_patch4_embeddingDim128/tensorboard
Warning: No default activation layers for model 'TinySwinUNet'. Monitoring all layers.
Activation logging enabled for all layers

Starting training for 35 epochs...


Epoch 1 [Train]:   0%|          | 0/480 [00:00<?, ?it/s]/opt/anaconda3/envs/dlvr_project/lib/python3.13/site-packages/torch/utils/data/dataloader.py:684: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
Epoch 1 [Train]:   0%|          | 0/480 [00:07<?, ?it/s]
TensorBoard logger closed.
Traceback (most recent call last):
  File "/Users/maria/Desktop/AU/FALL_2025_2026/DLVR/projects/FIVES_project/DPVS_ppln/scripts/train.py", line 126, in <module>
    main(args.config)
    ~~~~^^^^^^^^^^^^^
  File "/Users/maria/Desktop/AU/FALL_2025_2026/DLVR/projects/FIVES_project/DPVS_ppln/scripts/train.py", line 107, in main
    trainer.train()
    ~~~~~~~~~~~~~^^
  File "/Users/maria/Desktop/AU/FALL_2025_2026/DLVR/projects/FIVES_project/DPVS_ppln/src/training/trainer.py", line 90, in train
    train_metrics = self.train_epoch()
  File "/Users/maria/Desktop/AU/FALL_2025_2026/DLVR/projects/FIVES_project/DPVS_ppln/src/training/trainer.py", line 190, in train_epoch
    loss.backward()
    ~~~~~~~~~~~~~^^
  File "/opt/anaconda3/envs/dlvr_project/lib/python3.13/site-packages/torch/_tensor.py", line 647, in backward
    torch.autograd.backward(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        self, gradient, retain_graph, create_graph, inputs=inputs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/envs/dlvr_project/lib/python3.13/site-packages/torch/autograd/__init__.py", line 354, in backward
    _engine_run_backward(
    ~~~~~~~~~~~~~~~~~~~~^
        tensors,
        ^^^^^^^^
    ...<5 lines>...
        accumulate_grad=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/envs/dlvr_project/lib/python3.13/site-packages/torch/autograd/graph.py", line 829, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        t_outputs, *args, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )  # Calls into the C++ engine to run the backward pass
    ^
RuntimeError: view size is not compatible with input tensor's size and stride (at least one dimension spans across two contiguous subspaces). Use .reshape(...) instead.
